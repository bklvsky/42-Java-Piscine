# Module 05 â€“ Piscine Java

## SQL/JDBC

Summary: Today you will use the key mechanisms to work with PostgreSQL DBMS via
JDBC


## Contents

- I Rules of the Day
- II Exercise 00 : Tables and Entities
- III Exercise 01 : Read/Find
- IV Exercise 02 : Create/Save


# Chapter I

# Rules of the Day

- Use the PostgreSQL DBMS in all tasks.
- Connect the up-to-date version of JDBC driver.
- To interact with the database, you may use classes and interfaces of the java.sql
    package (implementations of corresponding interfaces will be automatically included
    from the archive containing the driver).


# Chapter II

# Exercise 00 : Tables and Entities

```
Exercise 00
```
```
Tables and Entities
Turn-in directory : ex 00 /
Files to turn in : Chat-folder
Allowed functions : n/a
```
Throughout this week, we will be implementing Chat functionality. In this chat, user can
create or choose an existing chatroom. Each chatroom can have several users exchanging
messages.

Create schema.sql file where you will describe CREATE TABLE operations to create
tables for the project. You should also create data.sql file with text data INSERTS (at least five in each table).


Additional requirements:

- To implement relational links, use one-to-many and many-to-many link types.
- Identifiers should be numeric.
- Identifiers shall be generated by DBMS.
- equals(), hashCode() and toString() shall be redefined correctly inside Java classes.


# Chapter III

# Exercise 01 : Read/Find

```
Exercise 01
```
```
Read/Find
Turn-in directory : ex 01 /
Files to turn in : Chat-folder
Allowed functions : n/a
```
Data Access Object (DAO, Repository) is a popular design pattern that allows to separate key business logic from data handling logic in an application.


You need to implement MessagesRepository with a SINGLE Optional<Message> findById(Long
id) method and its MessagesRepositoryJdbcImpl implementation.

This method shall return a Message object where author and chatroom will be specified.
In turn, there is NO NEED to enter subentities (list of chatrooms, chatroom creator,
etc.) for the author and the chatroom.

The implemented code must be tested in Program.java class. Example of the program
operation is as follows (the output may differ):


- MessagesRepositoryJdbcImpl shall accept DataSource interface of java.sql package
    as a constructor parameter.
- For DataSource implementation, use HikariCP library a pool of connections to the
    database which considerably expedite the use of storage.


# Chapter VI

# Exercise 02 : Create/Save

```
Exercise 02
```
```
Create/Save
Turn-in directory : ex 02 /
Files to turn in : Chat-folder
Allowed functions : n/a
```
Now you need to implement save(Message message) method for MessagesRepository.

Thus, we need to define the following subentities for the entity we are saving a message author and a chatroom. It is also important to assign IDs that exist in the database to chatroom and author.


- So, save method shall assign ID value for the incoming model after saving data in
    the database.
- If author and room have no ID existing in the database assigned, or these IDs
    are null, throw Runtimeexception NotSavedSubEntityException (implement this
    exception on your own).
- Test the implemented code in Program.java class.